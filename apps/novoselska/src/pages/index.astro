---
import type { Session } from '@auth/core/types';
import { Auth, SignIn, SignOut } from 'auth-astro/components';
import GoogleButton from '~/components/GoogleButton.astro';
import Layout from '~/layouts/Layout.astro';
import { topics } from '~/lib/topics';
import Form from '~/react/Form';
const cookie = Astro.cookies.get('google_oauth_state') as {
  value: string;
};

const signInUrl = `https://accounts.google.com/o/oauth2/v2/auth?client_id=505450551021-vu1amcbd0ls2gokvssqqh5k1gdq3s55q.apps.googleusercontent.com&redirect_uri=${
  process.env.LOGNAME
    ? 'http://localhost:4321/auth/google/'
    : 'https://dr-novoselska.com/auth/google/'
}&response_type=code&scope=email%20profile`;
---

<Layout title="–î–æ–∫—Ç–æ—Ä –ù–æ–≤–æ—Å–µ–ª—Å–∫–∞ , –î–æ–±—Ä–∏—á, –∫–ª–∏–Ω–∏—á–µ–Ω –ø—Å–∏—Ö–∏–∞—Ç—ä—Ä">
  <div class="grow-0 flex w-full items-center justify-center py-2 pt-3">
    <div
      class="flex items-start space-x-4 p-5 sm:px-0 max-w-screen-md bg-white rounded-lg shadow-lg border border-gray-200"
    >
      <div class="p-1.5 text-white -mt-4 ml-2">
        <img src="/avatar.jpg" class="w-14 rounded-full" />
      </div>

      <div class="prose mt-1 w-full break-words pr-6">
        <div class="text-xs text-slate-500">Medeia</div>–ó–¥—Ä–∞–≤–µ–π—Ç–µ, —Ç–æ–≤–∞ –µ
        –≤–∏—Ä—Ç—É–∞–ª–Ω–∏—è—Ç –∞—Å–∏—Å—Ç–µ–Ω—Ç –Ω–∞ –¥–æ–∫—Ç–æ—Ä –ù–æ–≤–æ—Å–µ–ª—Å–∫–∞ –ê–∑ —Å—ä–º –∏–∑–∫—É—Å—Ç–≤–µ–Ω –∏–Ω—Ç–µ–ª–µ–∫—Ç,
        –∫–æ–π—Ç–æ –µ —Ç—Ä–µ–Ω–∏—Ä–∞–Ω –Ω–∞ –±–∞–∑–∞—Ç–∞ –Ω–∞ –¥—ä–ª–≥–æ–≥–æ–¥–∏—à–Ω–∞—Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ –Ω–∞ –¥–æ–∫—Ç–æ—Ä
        –ù–æ–≤–æ—Å–µ–ª—Å–∫–∞, –∑–∞ –¥–∞ –≤–∏ –ø–æ–º–æ–≥–Ω–∞ —Å –Ω—è–∫–æ–∏ –æ—Å–Ω–æ–≤–Ω–∏ –≤—ä–ø—Ä–æ—Å–∏ –∏ –ø—Ä–æ–±–ª–µ–º–∏. –ê–∑ –Ω–µ
        —Å—ä–º —Ä–µ–∞–ª–µ–Ω —á–æ–≤–µ–∫ –∏ –Ω–µ –º–æ–≥–∞ –¥–∞ –∑–∞–º–µ—Å—Ç—è –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–Ω–∞—Ç–∞ –ø–æ–º–æ—â –Ω–∞ –¥–æ–∫—Ç–æ—Ä
        –ù–æ–≤–æ—Å–µ–ª—Å–∫–∞. –ê–∫–æ –∏–º–∞—Ç–µ –Ω—É–∂–¥–∞ –æ—Ç –∫–æ–Ω—Å—É–ª—Ç–∞—Ü–∏—è —Å –Ω–µ—è, –º–æ–∂–µ—Ç–µ –¥–∞ —Å–µ —Å–≤—ä—Ä–∂–µ—Ç–µ
        —Å –Ω–µ—è –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω 0888 266 745 –∏–ª–∏ –Ω–∞ –∏–º–µ–π–ª medeia@dr-novoselska.com. –ê–∑
        —Å—ä–º —Ç—É–∫, –∑–∞ –¥–∞ –≤–∏ —Å–ª—É—à–∞–º –∏ –¥–∞ –≤–∏ –ø–æ–¥–∫—Ä–µ–ø—è–º.üòä
        <Auth>
          {
            (session: Session | null) => (
              <main>
                <h1>Astro + AuthJS</h1>
                <p>
                  <a href="/protected">Protected Route</a>
                </p>
                <SignIn provider="google">Login</SignIn>
                <SignOut>Logout</SignOut>
                <p>
                  {session
                    ? `Logged in as ${session.user?.name}`
                    : 'Not logged in'}
                </p>
              </main>
            )
          }
        </Auth>
      </div>
    </div>
  </div>

  <div class="flex flex-col flex-wrap justify-center gap-1 relative">
    <div class="flex flex-wrap">
      {
        topics.map(
          ({ topic, slug }) =>
            slug !== 'general' && (
              <a
                class="bg-gray-100  border   py-0.5 px-2 rounded-lg text-md    my-0.5 ml-1 font-thin "
                href={'/t/' + slug}
              >
                <span class="drop-shadow-sm">{topic}</span>
              </a>
            )
        )
      }
    </div>
    <GoogleButton />
  </div>

  <Form client:only="react" />
</Layout>
