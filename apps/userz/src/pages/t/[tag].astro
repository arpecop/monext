---
import Layout from "../../components/Layout.astro";
import {gql} from "../../components/helpers/gql";
const { tag } = Astro.params as { tag: string };
 
 const resp  = await gql('tags',{_eq:tag}) as {qtags:{count:number, rows_with_tag:string[]}}
 
 if(!resp.qtags[0]) {
	  return Astro.redirect('/404')
  }
 const arr = resp.qtags[0].rows_with_tag.split(', ')
 const questions =  await gql('tagquestions',{_in:arr}) as {questions:{genid:string; text:string}[]}
  
---
<Layout title={tag} description={'#'+tag} logo={"inner"} topic={tag}>
	<main class="relative"> 
	 
		<div class="flex flex-col relative justify-center">
			<div>
 {questions.questions.map(({genid,text},i) => (<div  class="z-10 flex m-4 mb-5  text-xl  font-black  odd:rotate-1 even:-rotate-1 " >
			 <span class="z-10 text-gray-900  bg-gray-900 text-black  p-3 rounded-lg border-dashed border-2 border-emerald-900">{text.replaceAll('?',' ')}</span>
		 </div> )) }
 </div>
 <div class="absolute top-0">
  {questions.questions.map(({genid,text},i) => (<a  href={'/'+genid}   class="z-0 flex m-4 mb-6  text-xl  font-black rotate-0" >
			  <span class="z-10 text-gray-200  text-black  p-3 ">{text.replaceAll('?',' ')} </span>
		  </a> )) }
  </div>
 </div>
	</main>
</Layout>